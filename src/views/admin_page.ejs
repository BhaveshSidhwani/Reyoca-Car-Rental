<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <!-- Add CSS links here -->
    <style>
        /* Inline CSS for demonstration */
        .logout-button {
            position: fixed; /* Fixed position */
            right: 20px; /* 20px from the right */
            top: 20px; /* 20px from the top */
        }
    </style>
</head>
<body>
    
    <button id="logoutButton" onclick="logout()">Logout</button>
    <h1>Admin Dashboard</h1>

    <!-- Report Resolution Form -->
 
    <section>
        <h2>Reports Pending:</h2>
        <p>Filter Reports:</p>
        <form>
            <input type="text" name="reported_id" placeholder="Reported ID">
            <input type="text" name="reported_by" placeholder="Reported By">
            <input type="text" name="report_type" placeholder="Report Type">
            <input type="text" name="keyword" placeholder="Keyword in Description">
            <button type="submit">Filter</button>
        </form>
        <% if (reportData && reportData.length > 0) { %>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Reported By</th>
                        <th>Reported ID</th>
                        <th>Description</th>
                        <th>Report Type</th>
                    </tr>
                </thead>
                <tbody>
                    <% reportData.forEach(function(report) { %>
                        <tr>
                            <td><%= report.id %></td>
                            <td><%= report.reported_by %></td>
                            <td><%= report.reported_id %></td>
                            <td><%= report.description %></td>
                            <td><%= report.report_type %></td>
                            <td>
                                <!-- Resolve Button -->
                                <!-- Note: You might need to adjust the form's action URL -->
                                <form>
                                    <input type="hidden" name="_ID" value="<%= report.id %>">
                                    <button type="submit">Resolve</button>
                                </form>
                            </td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        <% } else { %>
            <p>No reports found.</p>
        <% } %>
    </section>
    
    <!-- Review Deletion Form -->
    <section>
        <h2>Delete Review</h2>
        <form>
            <input type="text" name="_ID" id="reviewID" placeholder="Enter Review ID" required>
            <button type="submit">Delete Review</button>
        </form>
    </section>

    

    <!-- User Deletion Form -->
    <section>
        <h2>Delete User</h2>
        <form>
            <input type="text" name="_ID" id="userID" placeholder="Enter User ID" required>
            <button type="submit" onclick="deleteuser()">Delete User</button>
        </form>
    </section>

    <!-- Listing Deletion Form -->
    <section>
        <h2>Delete Car Listing</h2>
        <form>
            <input type="text" name="_ID" id="listingID" placeholder="Enter Listing ID" required>
            <button type="submit" onclick="deletelisting()">Delete Listing</button>
        </form>
    </section>

    <!-- Add JavaScript here if necessary -->

</body>
<script>
    function logout() {
        fetch('/login/logout', {
            method: 'GET',
            headers: { 'Content-Type': 'application/json' }
            
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error); // or display the error message in the UI
            } else {
                alert('Logout Successful');
                // Additional logic after successful deletion (like redirecting)
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred');
        });
    }
    function deletelisting() {
        var reviewId = document.getElementById('listingID').value;
        var data = {
            _ID: reviewId
        };
        fetch('/admin/deletereview', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error); 
            } else {
                alert('Successfully Deleted');
                location.reload();
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred');
        });
    }
    function deletereview() {
        var reviewId = document.getElementById('reviewID').value;
        var data = {
            _ID: reviewId
        };
        fetch('/admin/deletereview', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error); 
            } else {
                alert('Successfully Deleted');
                location.reload();
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred');
        });
    }
    function deleteuser() {
        var user_id = document.getElementById('userID').value;
        console.log(user_id);
        var data = {
            _ID: user_id
        };
        fetch('http://localhost:3000/admin/deleteuser', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                alert(data.error); 
            } else {
                alert('User Successfully Deleted');
                location.reload();
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred');
        });
    }
</script>
</html>
